function H = calcTransformMatrix(u, v, x, y)

Q = [...
 u(1)	v(1)	1       0       0   	0	-u(1)*x(1)	-v(1)*x(1);
 u(2)	v(2)	1   	0       0       0	-u(2)*x(2)	-v(2)*x(2);
 u(3)	v(3)	1   	0       0       0	-u(3)*x(3)	-v(3)*x(3);
 u(4)	v(4)	1   	0       0       0	-u(4)*x(4)	-v(4)*x(4);
 0      0       0       u(1)    v(1)    1   -u(1)*y(1)  -v(1)*y(1);
 0      0       0       u(2)    v(2)    1   -u(2)*y(2)  -v(2)*y(2);
 0      0       0       u(3)    v(3)    1   -u(3)*y(3)  -v(3)*y(3);
 0      0       0       u(4)    v(4)    1   -u(4)*y(4)  -v(4)*y(4)
 ];

d = [x(1) x(2) x(3) x(4) y(1) y(2) y(3) y(4)].';

H = Q \ d;

H(9) = 1;

H = reshape(H, 3, 3).';